import { doc } from "$src/automation/exploits/references";
import { asyncWait } from "$server/utils/asyncUtils";

export function getButtonWithText(text: string) {
  return doc.evaluate(`//button[text()="${text}"]`, doc).iterateNext() as HTMLButtonElement;
}

export function clickButtonWithText(text: string) {
  const button = getButtonWithText(text);
  const handler = Object.keys(button)[1];

  button[handler].onClick({ isTrusted: true });
  return asyncWait(250);
}

export function getInputWithType(type: string) {
  return doc.evaluate(`//input[@type="${type}"]`, doc).iterateNext() as HTMLInputElement;
}

export function setInputValue(type: string, value: string) {
  const input = getInputWithType(type);
  const handler = Object.keys(input)[1];

  input.value = value;
  input[handler].onChange({ currentTarget: input });
  return asyncWait(250);
}
