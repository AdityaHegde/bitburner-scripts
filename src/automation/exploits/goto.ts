import { doc } from "$src/automation/exploits/references";
import { asyncWait } from "$server/utils/asyncUtils";

export function exitModal() {
  (doc.querySelector(".MuiBackdrop-root") as HTMLElement).click();
}

export function clickNav(text: string) {
  const c = doc.evaluate(`//p[text()="${text}"]`, doc).iterateNext() as HTMLElement;
  c?.click();
  return asyncWait(500);
}

export function clickLoc(label: string, nun: number) {
  const locations = doc.evaluate(`//b[text()="${label}"]`, doc);
  let location: HTMLElement;
  for (let i = 0; i < nun; i++) {
    location = locations.iterateNext() as HTMLElement;
  }
  location.click();
  return asyncWait(500);
}

export async function gotoLocation(label: string, num: number) {
  await clickNav("City");
  return clickLoc(label, num);
}
